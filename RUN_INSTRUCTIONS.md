# Инструкция по запуску экспериментов

В данном документе описаны команды для запуска экспериментов по симуляции эволюции коров.

## Основные сведения

Для запуска экспериментов используется скрипт `run_experiment.py`. Базовый синтаксис команды:

```
python run_experiment.py <experiment> [options]
```

где `<experiment>` — обязательный параметр, указывающий имя эксперимента для запуска, а `[options]` — дополнительные опции.

## Доступные параметры

### Основной параметр (обязательный)

- **experiment**: Имя эксперимента для запуска.
  - Синтаксис: `python run_experiment.py <experiment>`
  - Описание: Указывает, какой эксперимент нужно запустить. Должен быть одним из: `reproduction_comparison`, `climate_adaptation`.
  - Значение по умолчанию: отсутствует (параметр обязательный).

### Дополнительные параметры (опциональные)

- **--repeats**: Количество повторений эксперимента.
  - Синтаксис: `--repeats <int>`
  - Описание: Указывает, сколько раз нужно повторить симуляцию с разными начальными seed. Переопределяет значение из конфигурационного файла.
  - Значение по умолчанию: берётся из конфига эксперимента (`simulation.repeats`).

- **--seed**: Начальный seed для генерации случайных чисел.
  - Синтаксис: `--seed <int>`
  - Описание: Задаёт начальное значение для генератора случайных чисел. Используется для воспроизводимости результатов. Для каждого повторения seed увеличивается на 1.
  - Значение по умолчанию: берётся из конфига (`simulation.seed`), если не указан, то 42.

- **--years**: Количество лет симуляции.
  - Синтаксис: `--years <int>`
  - Описание: Задаёт продолжительность симуляции в годах. Один год соответствует `ticks_per_year` тикам (обычно 100). Переопределяет значение из конфига.
  - Значение по умолчанию: берётся из конфига (`simulation.years`).

- **--silent**: Тихий режим.
  - Синтаксис: `--silent`
  - Описание: Если указан, будут выводиться только прогресс-бары без дополнительных сообщений.
  - Значение по умолчанию: False (все сообщения выводятся).

- **--verbose**: Подробный режим вывода.
  - Синтаксис: `--verbose`
  - Описание: Если указан, будут выводиться все отладочные сообщения, в том числе из симуляции.
  - Значение по умолчанию: False (только важные сообщения).

## Примеры запуска

### Базовый запуск

Запуск эксперимента по сравнению типов размножения с параметрами по умолчанию:

```
python run_experiment.py reproduction_comparison
```

### Запуск с переопределением повторений

Запуск эксперимента по адаптации к климату с 5 повторениями:

```
python run_experiment.py climate_adaptation --repeats 5
```

### Запуск в тихом режиме

```
python run_experiment.py reproduction_comparison --silent
```

### Запуск с указанием seed и количества лет симуляции

```
python run_experiment.py reproduction_comparison --seed 123 --years 20
```

### Запуск с подробным выводом

```
python run_experiment.py climate_adaptation --verbose
```

## Советы и рекомендации

### Производительность

- Система автоматически использует все доступные ядра процессора для параллельного выполнения повторений, что обеспечивает максимальную скорость выполнения.
- Вы можете наблюдать параллельное выполнение нескольких симуляций с отдельными прогресс-барами для каждой из них.
- Если компьютер становится недостаточно отзывчивым во время выполнения, рекомендуется:
  - Уменьшить количество повторений (`--repeats`).
  - Запускать эксперименты на менее загруженном компьютере.

### Параметры override в конфигурационных файлах

Система поддерживает запуск экспериментов с разными значениями параметров. В файле `exp_config.json` в секции `override` можно указать списки значений для параметров:

```json
"override": {
  "cows.sexual_reproduce": [0, 1]
}
```

В этом случае будут созданы отдельные конфигурации для каждого значения параметра и эксперимент будет запущен для всех комбинаций параметров.

### Сохранение результатов

Результаты каждого эксперимента сохраняются в структурированном виде:
- Конфигурация эксперимента: `config.json`
- Статистика по каждому повторению: `repeat_<n>/stats.json`
- Подробные метрики: `repeat_<n>/metrics.csv`
- Общая сводка: `summary.json`

При нескольких конфигурациях (при использовании списков в override) результаты каждой конфигурации сохраняются в отдельных папках `config_<n>/`. 